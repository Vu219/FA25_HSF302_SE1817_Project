<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ho√†n t·∫•t thanh to√°n</title>

    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="stylesheet" th:href="@{/css/payment.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>

<header>
    <nav class="navbar container">
        <a th:href="@{/home}" class="logo">
            <i class="fas fa-train"></i> EVTrainTicket
        </a>
        <div class="nav-links" th:if="${session.user == null}">
            <a th:href="@{/login}">ƒêƒÉng nh·∫≠p</a>
            <a th:href="@{/register}">ƒêƒÉng k√Ω</a>
        </div>

        <div class="user-info" th:if="${session.user != null}">
            <p>Xin ch√†o, <strong th:text="${session.user.fullName}"></strong>!</p>

            <a th:href="@{/booking/history}" class="admin-nav-link" style="background-color: #28a745; border-color: #28a745;">
                <i class="fas fa-history"></i> V√© c·ªßa t√¥i
            </a>

            <a th:if="${session.user.role == 'ADMIN'}" th:href="@{/admin}" class="admin-nav-link">
                <i class="fas fa-cogs"></i> Qu·∫£n tr·ªã
            </a>

            <form th:action="@{/logout}" method="get" style="margin: 0;">
                <button type="submit">
                    <i class="fas fa-sign-out-alt"></i> ƒêƒÉng xu·∫•t
                </button>
            </form>
        </div>
    </nav>
</header>

<main>
    <div class="payment-container">
        <div class="header">
            <h1>üé´ Ho√†n t·∫•t thanh to√°n</h1>
            <p>Ki·ªÉm tra th√¥ng tin v√† ho√†n t·∫•t thanh to√°n c·ªßa b·∫°n</p>
        </div>

        <div class="booking-summary" th:if="${booking}">
            <h3>üìã T√≥m t·∫Øt v√©</h3>
            <div class="info-row">
                <span class="info-label">M√£ v√©:</span>
                <span class="info-value" th:text="${bookingCode}">BK12345678</span>
            </div>
            <div class="info-row">
                <span class="info-label">H√†nh kh√°ch:</span>
                <span class="info-value" th:text="${booking.user.fullName}">John Doe</span>
            </div>
            <div class="info-row">
                <span class="info-label">Email:</span>
                <span class="info-value" th:text="${booking.user.email}">john@example.com</span>
            </div>
            <div class="info-row">
                <span class="info-label">SƒêT:</span>
                <span class="info-value" th:text="${booking.user.phone}">1234567890</span>
            </div>
            <div class="info-row">
                <span class="info-label">S·ªë l∆∞·ª£ng v√©:</span>
                <span class="info-value" th:text="${booking.tickets.size()}">2</span>
            </div>
            <div class="info-row">
                <span class="info-label">Tr·∫°ng th√°i:</span>
                <span class="info-value" th:text="${booking.status}">PENDING</span>
            </div>
        </div>

        <div class="total-amount" th:if="${booking}">
            T·ªïng c·ªông: <span th:text="${#numbers.formatDecimal(booking.totalAmount, 0, 'COMMA', 0, 'POINT')} + ' VNƒê'"></span>
        </div>

        <div th:if="${booking == null}" class="error" style="display: block;">
            <h3>‚ùå Kh√¥ng t√¨m th·∫•y v√©</h3>
            <p>Kh√¥ng t√¨m th·∫•y th√¥ng tin v√© trong phi√™n l√†m vi·ªác. Vui l√≤ng <a href="/home">quay l·∫°i trang ch·ªß</a> v√† ƒë·∫∑t l·∫°i.</p>
        </div>

        <div th:if="${booking != null}">
            <button class="payment-button" id="paymentBtn">
                üí≥ Ho√†n t·∫•t thanh to√°n
            </button>
        </div>

        <div id="result" class="result"></div>
    </div>
</main>

<footer>
    <p>&copy; 2025 EVTrainTicket. All rights reserved.</p>
</footer>

<script th:src="@{/js/payment.js}"></script>
</body>
</html>

